<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Веб‑платформа подготовки специалистов</title>
  <link rel="stylesheet" href="style.css">
 
</head>
<body class="design-mode">
  <div class="design-container">
    <!-- Верхняя панель как на картинке -->
    <div class="top-bar">
      <div class="top-bar-right">
        <button class="btn-documentation" onclick="navigateTo('documentation.html')"></button>
        <button class="btn-exam" id="exam-btn" onclick="checkBlockAndNavigate('simulation.html')"></button>
        <button class="btn-trainer" onclick="navigateTo('trainer.html')"></button>
        <button class="btn-alisa" onclick="navigateTo('alisa.html')"></button>
        <button class="btn-profile" onclick="navigateTo('profile.html')"></button>
      </div>
    </div>
    
    <div class="main-content">
      <h1 class="greeting">Здравствуйте, Гость!</h1>
      
      <div class="description">
        Здесь вы можете тренироваться для прохождения аттестации по охране труда. 
        Вы можете как свободно решать билеты, так и проверить свои знания в симуляторе экзамена. 
        Также вы можете удобно тренироваться с помощью Яндекс Алисы. Удачного обучения!
      </div>
      
      <button class="start-main-button" onclick="showBlocks()"></button>
      
      <div class="guest-notice">
        * В гостевом режиме вам доступны тренировки без сохранения прогресса и просмотр вопросов по блокам и разделам.
      </div>
    </div>
    
    <div class="blocks-container" id="blocks-container">
      <h3 style="margin-bottom: 30px; color: #333;">Выберите блок для обучения:</h3>
      
      <div id="selected-block-info" style="display:none; background:#e8f4fd; padding:15px; margin:20px 0; border-radius:8px; border-left:4px solid #2196F3;">
        <strong>Выбран блок: <span id="current-selected-block">-</span></strong>
        <p style="margin:5px 0 0 0; font-size:14px; color:#666;">Теперь вы можете запустить симуляцию экзамена</p>
      </div>
      
      <div class="blocks">
        <div class="block">
          <h4>СИЗ</h4>
          <p>Основные темы и задачи. Вопросы по нормативной документации.</p>
          <button class="button select-block-btn" data-block="Блок 1" onclick="selectBlock('Блок 1')">Выбрать блок</button>
        </div>
        <div class="block">
          <h4>А</h4>
          <p>Практические навыки и тесты. Применение СИЗ на практике.</p>
          <button class="button select-block-btn" data-block="Блок 2" onclick="selectBlock('Блок 2')">Выбрать блок</button>
        </div>
        <div class="block">
          <h4>ОПП</h4>
          <p>Теоретические основы. Классификация и требования к СИЗ.</p>
          <button class="button select-block-btn" data-block="Блок 3" onclick="selectBlock('Блок 3')">Выбрать блок</button>
        </div>
        <div class="block">
          <h4>Б</h4>
          <p>Продвинутая практика. Сложные случаи и исключения.</p>
          <button class="button select-block-btn" data-block="Блок 4" onclick="selectBlock('Блок 4')">Выбрать блок</button>
        </div>
        <div class="block">
          <h4>В</h4>
          <p>Блок 5.</p>
          <button class="button select-block-btn" data-block="Блок 5" onclick="selectBlock('Блок 5')">Выбрать блок</button>
        </div>
      </div>
    </div>
  </div>
  
  <script src="data-loader.js"></script>
  <script src="navigation.js"></script>
  
  <script>
    // Функция показа блоков после нажатия НАЧАТЬ
    function showBlocks() {
      document.querySelector('.main-content').style.display = 'none';
      document.getElementById('blocks-container').style.display = 'block';
      document.querySelector('.mode-toggle').textContent = 'Вернуться на главную';
      document.querySelector('.mode-toggle').onclick = function() {
        document.querySelector('.main-content').style.display = 'flex';
        document.getElementById('blocks-container').style.display = 'none';
        this.textContent = 'Переключить вид';
        this.onclick = switchToOldDesign;
      };
      
      // Инициализируем навигацию
      if (typeof updateSimulationButton === 'function') {
        updateSimulationButton();
      }
    } 
    
    // Функция проверки блока и навигации
    function checkBlockAndNavigate(page) {
      const selectedBlock = localStorage.getItem('selectedBlock');
      
      if (!selectedBlock) {
        alert('Сначала выберите блок для обучения! Нажмите "НАЧАТЬ" и выберите блок.');
        showBlocks();
        return;
      }
      
      // Проверяем вопросы
      if (typeof questionsData !== 'undefined') {
        const blockQuestions = questionsData[selectedBlock];
        if (!blockQuestions || blockQuestions.length === 0) {
          alert(`Для блока "${selectedBlock}" нет вопросов!`);
          return;
        }
      }
      
      navigateTo(page);
    }
    
    // Функция выбора блока (из navigation.js)
    function selectBlock(blockName) {
      // Ваша существующая логика из navigation.js
      if (typeof selectBlock === 'function') {
        window.selectBlock(blockName);
      } else {
        // Простая реализация
        localStorage.setItem('selectedBlock', blockName);
        
        // Показываем информацию о выбранном блоке
        document.getElementById('selected-block-info').style.display = 'block';
        document.getElementById('current-selected-block').textContent = blockName;
        
        // Обновляем кнопки
        document.querySelectorAll('.select-block-btn').forEach(btn => {
          if (btn.getAttribute('data-block') === blockName) {
            btn.style.backgroundColor = '#4CAF50';
            btn.textContent = '✓ Выбран';
          } else {
            btn.style.backgroundColor = '#dd2222';
            btn.textContent = 'Выбрать блок';
          }
        });
        
        // Обновляем кнопку экзамена
        const examBtn = document.getElementById('exam-btn');
        examBtn.disabled = false;
        examBtn.style.opacity = '1';
        examBtn.style.cursor = 'pointer';
        
        alert(`Блок "${blockName}" выбран! Теперь вы можете начать экзамен.`);
      }
    }
    
    // Функция навигации
    function navigateTo(page) {
      window.location.href = page;
    }
    
    // Инициализация при загрузке
    document.addEventListener('DOMContentLoaded', function() {
      // Проверяем выбран ли блок для активации кнопки экзамена
      const selectedBlock = localStorage.getItem('selectedBlock');
      const examBtn = document.getElementById('exam-btn');
      
      if (selectedBlock) {
        examBtn.disabled = false;
        examBtn.style.opacity = '1';
        examBtn.style.cursor = 'pointer';
      } else {
        examBtn.disabled = true;
        examBtn.style.opacity = '0.5';
        examBtn.style.cursor = 'not-allowed';
      }
    });
  </script>
</body>
</html>